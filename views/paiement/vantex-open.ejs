<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Créer un compte VANTEX</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css"/>

<style>
body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #11998e,#0575e6);
  min-height: 100vh;
  padding: 0;
}

/* WRAPPER */
.card-wrapper {
  max-width: 1100px;
  margin: 40px auto;
  background: #fff;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
}

/* IMAGE */
.card-img {
  width: 100%;
  height: 230px;
  background: url('/images/vantex.jpg') center/cover no-repeat;
  order: 2;
}
@media (min-width: 920px) {
  .card-wrapper { flex-direction: row; }
  .card-img {
    width: 40%;
    height: auto;
    order: 0;
  }
}

/* FORM + VERIFY */
.card { padding: 40px; width: 100%; }

/* TITRE */
h1 {
  text-align: center;
  color: #0A9999;
  font-size: 2rem;
  margin-bottom: 10px;
}
.subtitle { text-align: center; margin-bottom: 25px; color: #555; }

/* GRID */
.form-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 25px;
}
@media (min-width: 850px) {
  .form-grid { grid-template-columns: 1fr 1fr; }
}

/* FIELD */
.field { position: relative; }
.field input, .field select {
  width: 100%;
  height: 50px;
  border: 1.7px solid #dce3e8;
  border-radius: 10px;
  padding: 0 14px;
  font-size: 1rem;
  background: #fff;
}
.field label {
  position: absolute;
  top:-10px;
  left: 14px;
  background: #fff;
  padding: 0 6px;
  font-size: .80rem;
  color: #0A9999;
}

/* BOUTONS */
.btn {
  width: 100%;
  height: 52px;
  border: none;
  background: #0A9999;
  color: #fff;
  border-radius: 10px;
  font-size: 1.1rem;
  cursor: pointer;
  margin-top: 15px;
}
.btn:hover { background:#087a7a; }

/* PAGE 2 (VÉRIFICATION) */
#verifyPage {
  display: none;
}

.verify-box {
  padding: 20px;
  background: #f7ffff;
  border-radius: 12px;
  border: 2px solid #0A9999;
}

.verify-title {
  font-size: 1.3rem;
  font-weight: 600;
  color:#0A9999;
  margin-bottom: 12px;
}

.verify-line {
  margin: 6px 0;
  font-size: 1rem;
  color: #333;
  background: #fff;
  padding: 10px;
  border-radius: 8px;
}

.back-btn {
  background: #666;
  margin-top: 20px;
}
.back-btn:hover { background:#444; }
</style>
</head>

<body>

<div class="card-wrapper">

  <div class="card">

    <!-- PAGE 1 : FORMULAIRE -->
    <div id="formPage">
      <h1>Créer un compte VANTEX</h1>
      <p class="subtitle">Remplissez le formulaire ci-dessous puis vérifiez vos informations.</p>

      <form id="vantexForm" enctype="multipart/form-data">

        <div class="form-grid">

          <div class="field">
            <select id="civility" required>
              <option value="" disabled selected></option>
              <option>M.</option>
              <option>Mme</option>
              <option>Mlle</option>
            </select>
            <label>Civilité</label>
          </div>

          <div class="field">
            <input type="text" id="firstname" required>
            <label>Prénom</label>
          </div>

          <div class="field" style="grid-column:1/-1;">
            <input type="text" id="lastname" required>
            <label>Nom</label>
          </div>

          <div class="field">
            <input type="email" id="email" required>
            <label>Email</label>
          </div>

          <div class="field">
            <label style="top:-10px;">Téléphone</label>
            <input type="tel" id="phone" required>
          </div>

          <div class="field" style="grid-column:1/-1;">
            <input type="text" id="profession" required>
            <label>Profession</label>
          </div>

          <div class="field">
            <select id="country" required></select>
            <label>Pays</label>
          </div>

          <div class="field">
            <input type="text" id="region" required>
            <label>Région / Province</label>
          </div>

          <div class="field" style="grid-column:1/-1;">
            <input type="text" id="street" required>
            <label>Rue</label>
          </div>

          <div class="field">
            <input type="text" id="city" required>
            <label>Ville</label>
          </div>

          <div class="field">
            <input type="text" id="zip" required>
            <label>Code postal</label>
          </div>

          <div class="field" style="grid-column:1/-1;">
            <input type="file" id="id_front" required>
            <label>Document d'identité — recto</label>
          </div>

          <div class="field" style="grid-column:1/-1;">
            <input type="file" id="id_back" required>
            <label>Document d'identité — verso</label>
          </div>
        </div>

        <button type="button" class="btn" onclick="goToVerify()">Vérifier mes informations →</button>

      </form>
    </div>

    <!-- PAGE 2 : VÉRIFICATION -->
    <div id="verifyPage">

      <h1>Vérification des informations</h1>
      <p class="subtitle">Veuillez confirmer les détails ci-dessous avant de valider votre demande.</p>

      <div class="verify-box" id="verifyContent"></div>

      <button class="btn back-btn" onclick="backToForm()">← Modifier</button>

      <form action="/paiement/vantex/submit" method="POST" enctype="multipart/form-data" id="finalSubmitForm"></form>

      <button class="btn" onclick="submitFinal()">Soumettre ma demande ✔</button>

    </div>

  </div>

  <div class="card-img"></div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

<script>
// INIT TEL INPUT
const phoneInput = window.intlTelInput(document.getElementById("phone"), {
  initialCountry: "fr",
  separateDialCode: true
});

// CHARGEMENT PAYS
async function loadCountries() {
  const res = await fetch("/json/countries.json");
  const data = await res.json();
  data.sort((a,b)=>a.name.common.localeCompare(b.name.common));

  const sel = document.getElementById("country");
  data.forEach(c=>{
    let op=document.createElement("option");
    op.value = c.name.common;
    op.textContent = c.name.common;
    sel.appendChild(op);
  });
}
loadCountries();


// =======================
//  TRANSITION PAGE 1 → 2
// =======================
function goToVerify() {
  const fields = [
    "civility","firstname","lastname","email",
    "profession","country","region","street","city","zip"
  ];

  let html = "";

  fields.forEach(id=>{
    const v = document.getElementById(id).value.trim();
    html += `<div class="verify-line"><b>${id}</b> : ${v}</div>`;
  });

  html += `<div class="verify-line"><b>Téléphone</b> : ${phoneInput.getNumber()}</div>`;

  document.getElementById("verifyContent").innerHTML = html;

  document.getElementById("formPage").style.display = "none";
  document.getElementById("verifyPage").style.display = "block";
}

// =======================
//  Retour page formulaire
// =======================
function backToForm() {
  document.getElementById("verifyPage").style.display = "none";
  document.getElementById("formPage").style.display = "block";
}

// =======================
//  Envoi final
// =======================
function submitFinal() {
  const form = document.getElementById("finalSubmitForm");
  const original = document.getElementById("vantexForm");

  const fd = new FormData(original);

  fetch("/paiement/vantex/submit", {
    method: "POST",
    body: fd
  }).then(()=> window.location.href = "/paiement/vantex/merci");
}
</script>

</body>
</html>


