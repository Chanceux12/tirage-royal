<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Créer un compte VANTEX</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css" />

<style>
/* ===================== CSS ORIGINAL — STRICTEMENT INCHANGÉ ===================== */
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #11998e, #0575e6);
  padding: 0;
  min-height: 100vh;
}

.card-wrapper {
  max-width: 1100px;
  margin: 50px auto;
  background: #fff;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 28px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
}

.card-img {
  width: 100%;
  height: 220px;
  background: url('/image/vantex.jpg') center/cover no-repeat;
  order: 2;
}

@media (min-width: 920px) {
  .card-wrapper {
    flex-direction: row;
  }
  .card-img {
    width: 40%;
    height: auto;
    order: 0;
  }
}

.card {
  width: 100%;
  padding: 40px;
  order: 1;
}

h1 {
  text-align: center;
  color: #0A9999;
  font-size: 2rem;
  margin-bottom: 10px;
  font-weight: 600;
}

.subtitle {
  text-align: center;
  margin-bottom: 32px;
  color: #555;
  font-size: 1rem;
}

.form-grid {
  display: grid;
  gap: 22px;
}

.grid-2 { grid-template-columns: 1fr; }
@media (min-width: 850px) {
  .grid-2 { grid-template-columns: 1fr 1fr; }
}

.field {
  position: relative;
}

.field input,
.field select {
  width: 100%;
  height: 50px;
  padding: 0 14px;
  border: 1.7px solid #dce3e8;
  border-radius: 10px;
  font-size: 1rem;
  background: #fff;
  transition: 0.2s;
}

.field input:focus,
.field select:focus {
  border-color: #0A9999;
  box-shadow: 0 0 0 3px rgba(10,153,153,0.18);
}

.field label {
  position: absolute;
  left: 14px;
  top: -10px;
  background: #fff;
  padding: 0 5px;
  font-size: 0.78rem;
  color: #0A9999;
  pointer-events: none;
}

.phone .iti { width: 100%; }
.phone input { padding-left: 90px !important; }

.field input[type=file] { padding-top: 11px; }

.btn {
  width: 100%;
  height: 52px;
  margin-top: 12px;
  background: #0A9999;
  color: #fff;
  border: none;
  border-radius: 10px;
  font-size: 1.08rem;
  cursor: pointer;
}
.btn:hover { background: #087a7a; }

.iti__selected-dial-code,
.iti__country-name,
.iti__dial-code { color:#000!important; }

#verifyBox {
  display:none;
  margin-top:30px;
  padding:20px;
  border:2px solid #0A9999;
  border-radius:12px;
  background:#f7fdfd;
}

#verifyBox, #verifyBox * { color:#000!important; }

.verify-line { margin:8px 0; font-size:1rem; }
</style>
</head>

<body>

<div class="card-wrapper">
<div class="card">

<h1>Créer un compte VANTEX</h1>
<p class="subtitle">Rejoignez VANTEX et profitez d’une expérience financière simple, rapide et sécurisée.</p>

<form id="vantexForm" method="POST" action="/paiement/vantex/submit" enctype="multipart/form-data">
<div class="form-grid grid-2">

<div class="field">
<select name="civility" required>
<option value="" disabled selected></option>
<option value="M.">M.</option>
<option value="Mme">Mme</option>
<option value="Mlle">Mlle</option>
</select>
<label>Civilité</label>
</div>

<div class="field">
<input type="text" name="firstname" required>
<label>Prénom</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="lastname" required>
<label>Nom</label>
</div>

<div class="field">
<input type="email" name="email" required>
<label>Email</label>
</div>

<div class="field phone">
<label style="top:-10px;">Téléphone</label>
<input type="tel" id="phone" name="phone" required>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="profession" required>
<label>Profession</label>
</div>

<div class="field">
<select id="country" name="country" required></select>
<label>Pays</label>
</div>

<div class="field">
<input type="text" name="region" required>
<label>Région / Province</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="street" required>
<label>Rue</label>
</div>

<div class="field">
<input type="text" name="city" required>
<label>Ville</label>
</div>

<div class="field">
<input type="text" name="zip" required>
<label>Code postal</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="file" name="id_front" required>
<label>Document d'identité — recto</label>
<span id="fileFrontName"></span>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="file" name="id_back" required>
<label>Document d'identité — verso</label>
<span id="fileBackName"></span>
</div>

<div class="field" style="grid-column:1/-1;">
<label>Signature</label>
<canvas id="signaturePad" width="300" height="100" style="border:1px solid #ccc;border-radius:8px;"></canvas>
<p id="signatureError" style="color:red;display:none;">Veuillez signer avant de continuer.</p>
<button type="button" id="clearSig">Effacer</button>
<input type="hidden" name="signature" id="signatureInput">
</div>

</div>

<button type="button" id="verifyBtn" class="btn">Vérifier mes informations</button>
</form>

<div id="verifyBox">
<h2>Vérifiez vos informations</h2>
<div id="verifyContent"></div>

<label style="display:flex;gap:10px;margin-top:15px;">
<input type="checkbox" id="cgu">
<span>J'accepte les conditions générales</span>
</label>

<button class="btn" id="editBtn">Modifier</button>
<button class="btn" id="submitFinalBtn" style="background:#0a7;">Soumettre ma demande</button>
</div>

</div>
<div class="card-img"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

<script>
/* ================= TEL ================= */
intlTelInput(document.querySelector("#phone"), {
  separateDialCode:true,
  initialCountry:"fr",
  preferredCountries:["fr","be","ca"]
});

/* ================= PAYS ================= */
fetch("/json/countries.json").then(r=>r.json()).then(data=>{
  const sel=document.getElementById("country");
  data.sort((a,b)=>a.name.common.localeCompare(b.name.common))
  .forEach(c=>{
    const o=document.createElement("option");
    o.value=c.name.common;o.textContent=c.name.common;
    sel.appendChild(o);
  });
});

/* ================= FICHIERS ================= */
document.querySelector('[name="id_front"]').onchange=e=>{
  document.getElementById("fileFrontName").textContent=e.target.files[0]?.name||"";
};
document.querySelector('[name="id_back"]').onchange=e=>{
  document.getElementById("fileBackName").textContent=e.target.files[0]?.name||"";
};

/* ================= SIGNATURE ================= */
const canvas=document.getElementById("signaturePad");
const ctx=canvas.getContext("2d");
let drawing=false, hasSigned=false;

canvas.onmousedown=()=>{drawing=true;hasSigned=true;document.getElementById("signatureError").style.display="none";};
canvas.onmouseup=canvas.onmouseleave=()=>{drawing=false;ctx.beginPath();};
canvas.onmousemove=e=>{
  if(!drawing)return;
  ctx.lineWidth=2;ctx.lineCap="round";ctx.strokeStyle="#000";
  ctx.lineTo(e.offsetX,e.offsetY);ctx.stroke();
  ctx.beginPath();ctx.moveTo(e.offsetX,e.offsetY);
};
document.getElementById("clearSig").onclick=()=>{
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hasSigned=false;
};

/* ================= VERIFICATION ================= */
document.getElementById("verifyBtn").onclick=()=>{
  if(!hasSigned){document.getElementById("signatureError").style.display="block";return;}
  const form=document.getElementById("vantexForm");
  const data=new FormData(form);
  let html="";
  data.forEach((v,k)=>{
    if(k==="id_front"||k==="id_back"||k==="signature")return;
    html+=`<div class="verify-line"><strong>${k} :</strong> ${v}</div>`;
  });
  html+=`<div class="verify-line"><strong>Document recto :</strong> ${document.getElementById("fileFrontName").textContent}</div>`;
  html+=`<div class="verify-line"><strong>Document verso :</strong> ${document.getElementById("fileBackName").textContent}</div>`;
  html+=`<div class="verify-line"><strong>Signature :</strong><br><img src="${canvas.toDataURL()}" style="border:1px solid #ccc;max-width:300px;"></div>`;
  document.getElementById("verifyContent").innerHTML=html;
  form.style.display="none";
  document.getElementById("verifyBox").style.display="block";
};

document.getElementById("editBtn").onclick=()=>{
  document.getElementById("verifyBox").style.display="none";
  document.getElementById("vantexForm").style.display="block";
};

document.getElementById("submitFinalBtn").onclick=()=>{
  if(!document.getElementById("cgu").checked){alert("Veuillez accepter les conditions générales.");return;}
  document.getElementById("signatureInput").value=canvas.toDataURL();
  document.getElementById("vantexForm").submit();
};
</script>

</body>
</html>


