<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cr√©er un compte VANTEX</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css" />

<style>
/* ===== CSS ORIGINAL ‚Äî AUCUNE MODIFICATION ===== */
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #11998e, #0575e6);
  padding: 0;
  min-height: 100vh;
}

.card-wrapper {
  max-width: 1100px;
  margin: 50px auto;
  background: #fff;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 28px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
}

.card-img {
  width: 100%;
  height: 220px;
  background: url('/image/vantex.jpg') center/cover no-repeat;
  order: 2;
}

@media (min-width: 920px) {
  .card-wrapper { flex-direction: row; }
  .card-img { width: 40%; height: auto; order: 0; }
}

.card { width: 100%; padding: 40px; order: 1; }

h1 {
  text-align: center;
  color: #0A9999;
  font-size: 2rem;
  margin-bottom: 10px;
  font-weight: 600;
}

.subtitle {
  text-align: center;
  margin-bottom: 32px;
  color: #555;
  font-size: 1rem;
}

.form-grid { display: grid; gap: 22px; }
.grid-2 { grid-template-columns: 1fr; }
@media (min-width: 850px) {
  .grid-2 { grid-template-columns: 1fr 1fr; }
}

.field { position: relative; }

.field input,
.field select {
  width: 100%;
  height: 50px;
  padding: 0 14px;
  border: 1.7px solid #dce3e8;
  border-radius: 10px;
  font-size: 1rem;
  background: #fff;
}

.field label {
  position: absolute;
  left: 14px;
  top: -10px;
  background: #fff;
  padding: 0 5px;
  font-size: 0.78rem;
  color: #0A9999;
}

.phone .iti { width: 100%; }
.phone input { padding-left: 90px !important; }

.btn {
  width: 100%;
  height: 52px;
  margin-top: 12px;
  background: #0A9999;
  color: #fff;
  border: none;
  border-radius: 10px;
  font-size: 1.08rem;
  cursor: pointer;
}

#verifyBox {
  display: none;
  margin-top: 30px;
  padding: 20px;
  border: 2px solid #0A9999;
  border-radius: 12px;
  background: #f7fdfd;
}

#verifyBox,
#verifyBox * { color: #000 !important; }
</style>
</head>

<body>

<div class="card-wrapper">

<div class="card">
<h1>Cr√©er un compte VANTEX</h1>
<p class="subtitle">Rejoignez VANTEX et profitez d‚Äôune exp√©rience financi√®re simple, rapide et s√©curis√©e.</p>

<form id="vantexForm" method="POST" action="/paiement/vantex/submit" enctype="multipart/form-data">
<div class="form-grid grid-2">

<div class="field">
<select name="civility" required>
<option value="" disabled selected></option>
<option value="M.">M.</option>
<option value="Mme">Mme</option>
<option value="Mlle">Mlle</option>
</select>
<label>Civilit√©</label>
</div>

<div class="field">
<input type="text" name="firstname" required />
<label>Pr√©nom</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="lastname" required />
<label>Nom</label>
</div>

<div class="field">
<input type="email" name="email" required />
<label>Email</label>
</div>

<div class="field phone">
<label style="top:-10px;">T√©l√©phone</label>
<input type="tel" id="phone" name="phone" required />
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="profession" required />
<label>Profession</label>
</div>

<div class="field">
<select id="country" name="country" required></select>
<label>Pays</label>
</div>

<div class="field">
<input type="text" name="region" required />
<label>R√©gion / Province</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="text" name="street" required />
<label>Rue</label>
</div>

<div class="field">
<input type="text" name="city" required />
<label>Ville</label>
</div>

<div class="field">
<input type="text" name="zip" required />
<label>Code postal</label>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="file" name="id_front" required />
<label>Document d'identit√© ‚Äî recto</label>
<div id="fileFrontName"></div>
</div>

<div class="field" style="grid-column:1/-1;">
<input type="file" name="id_back" required />
<label>Document d'identit√© ‚Äî verso</label>
<div id="fileBackName"></div>
</div>

<div class="field" style="grid-column:1/-1;">
<label>Signature</label>
<canvas id="signaturePad" width="300" height="100" style="border:1px solid #ccc;"></canvas>
<p id="signatureError" style="color:red; display:none;">Veuillez signer avant de continuer.</p>
<button type="button" id="clearSig">Effacer</button>
<input type="hidden" name="signature" id="signatureInput">
</div>

</div>

<button type="button" id="verifyBtn" class="btn">V√©rifier mes informations</button>
</form>

<div id="verifyBox">
<h2>V√©rifiez vos informations</h2>
<div id="verifyContent"></div>

<label style="display:flex; gap:10px; margin-top:15px;">
<input type="checkbox" id="cgu">
<span>J'accepte les conditions g√©n√©rales</span>
</label>

<button class="btn" id="editBtn">Modifier</button>
<button class="btn" id="submitFinalBtn" style="background:#0a7;">Soumettre ma demande</button>
</div>

</div>
<div class="card-img"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

<script>
/* TEL */
intlTelInput(document.querySelector("#phone"), { initialCountry:"fr" });

/* NOM DES FICHIERS */
document.querySelector('[name="id_front"]').onchange = e=>{
  fileFrontName.textContent = "üìÑ " + e.target.files[0].name;
};
document.querySelector('[name="id_back"]').onchange = e=>{
  fileBackName.textContent = "üìÑ " + e.target.files[0].name;
};

/* SIGNATURE */
const canvas = signaturePad;
const ctx = canvas.getContext("2d");
let signed = false, draw=false;

canvas.onmousedown=()=>{draw=true; signed=true; signatureError.style.display="none";}
canvas.onmouseup=()=>{draw=false; ctx.beginPath();}
canvas.onmousemove=e=>{
  if(!draw) return;
  ctx.lineWidth=2; ctx.strokeStyle="#000";
  ctx.lineTo(e.offsetX,e.offsetY); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(e.offsetX,e.offsetY);
};
clearSig.onclick=()=>{ctx.clearRect(0,0,300,100); signed=false;};

/* VERIFICATION */
verifyBtn.onclick=()=>{
  if(!signed){ signatureError.style.display="block"; return; }

  let html="";
  new FormData(vantexForm).forEach((v,k)=>{
    if(k==="id_front"||k==="id_back"||k==="signature") return;
    html+=`<div><strong>${k} :</strong> ${v}</div>`;
  });

  html+=`<div><strong>Document recto :</strong> ${fileFrontName.textContent}</div>`;
  html+=`<div><strong>Document verso :</strong> ${fileBackName.textContent}</div>`;
  html+=`<div><strong>Signature :</strong><br><img src="${canvas.toDataURL()}" width="300"></div>`;

  verifyContent.innerHTML=html;
  vantexForm.style.display="none";
  verifyBox.style.display="block";
};

editBtn.onclick=()=>{
  verifyBox.style.display="none";
  vantexForm.style.display="block";
};

submitFinalBtn.onclick=()=>{
  if(!cgu.checked){ alert("Veuillez accepter les conditions g√©n√©rales."); return; }
  signatureInput.value=canvas.toDataURL();
  vantexForm.submit();
};
</script>

</body>
</html>

